// XAML Map Control - https://github.com/ClemensFischer/XAML-Map-Control
// © 2020 Clemens Fischer
// Licensed under the Microsoft Public License (Ms-PL)

using System;
using System.Collections.Generic;
using System.Collections.Immutable;
using System.Runtime.CompilerServices;
#if WINDOWS_UWP
using Windows.Foundation;
#else
using System.Windows;
#endif

namespace MapControl
{
    /// <summary>
    /// TThe Eckert IV projection is an equal-area pseudocylindrical map projection. 
    /// The length of the polar lines is half that of the equator, and lines of longitude 
    /// are semiellipses, or portions of ellipses. 
    /// 
    /// https://en.wikipedia.org/wiki/Eckert_IV_projection
    /// </summary>
    public class EckertIVProjection : MapProjection
    {
        private const double TwoPiHalf = 2.0 + Math.PI / 2.0;
        private static readonly double xConst = 
            2.0 * Wgs84MetersPerDegree / Math.Sqrt(4.0 * Math.PI + Math.PI * Math.PI);
        private static readonly double yConst = 
            2.0 * Math.Sqrt(Math.PI / (4.0 + Math.PI)) * Wgs84EquatorialRadius;

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public static double DegreesToRadians(double degrees)
        {
            return degrees / 180.0 * Math.PI;
        }
        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        public static double RadiansToDegrees(double radians)
        {
            return radians * 180.0 / Math.PI;
        }

        private class LatitudeCompareScale : IComparer<Scale>
        {
#if DOTNET_CORE
            public int Compare([AllowNull] Scale x, [AllowNull] Scale y)
#else
            public int Compare(Scale x, Scale y)
#endif
            {
                return x.theta.CompareTo(y.theta);
            }
        }

        private class Scale
        {
            public readonly double latitude;
            public readonly double theta;
            public readonly double thetaSin;
            public readonly double thetaCos;

            public Scale(double l, double th)
            {
                latitude = l;
                theta = DegreesToRadians(th);
                thetaSin = Math.Sin(theta);
                thetaCos = Math.Cos(theta);
            }

            public override string ToString()
            {
                return $"{latitude},{theta}";
            }

            public static Scale FindScale(
                ImmutableSortedSet<Scale> scalesLookup, 
                Func<Scale, double> getCompareValue,
                double index)
            {
                var low = 0;
                var high = scalesLookup.Count - 1;

                do
                {
                    var mid = (int)Math.Floor(((high - low) / 2.0) + low);
                    var midScale = scalesLookup[mid];
                    if (mid == low)
                        return midScale;

                    var comparision = index.CompareTo(getCompareValue(midScale));
                    if (comparision == 0)
                        return midScale;
                    else if (comparision > 0)
                        low = mid;
                    else
                        high = mid;
                } while (high > low);
                return scalesLookup[high];
            }
        }

        /// <summary>
        /// θ can be solved for numerically using Newton's method, but it is
        /// time consuming, so precalc
        /// </summary>
        private static Scale[] Scales =
            new Scale[] {//latitude,θ
                new Scale(-89.5,-90.67071809122005),
                new Scale(-89.4,-90.80549967744284),
                new Scale(-89.3,-90.94049647712016),
#region MostScales
                new Scale(-89.2,-91.07571081261808),
                new Scale(-89.1,-91.2111429196337),
                new Scale(-89,-91.3467955197448),
                new Scale(-88.9,-91.48266923057642),
                new Scale(-88.8,-91.61876601386052),
                new Scale(-88.7,-91.75508627302688),
                new Scale(-88.6,-91.89163234710234),
                new Scale(-88.5,-92.02840559425566),
                new Scale(-88.4,-92.1654075540072),
                new Scale(-88.3,-92.30263934992928),
                new Scale(-88.2,-92.44010287714656),
                new Scale(-88.1,-92.57779960961979),
                new Scale(-88,-92.71573058503668),
                new Scale(-87.9,-92.85389821999239),
                new Scale(-87.8,-92.9923032736621),
                new Scale(-87.7,-93.13094788329427),
                new Scale(-87.6,-93.26983373563824),
                new Scale(-87.5,-93.40896204978507),
                new Scale(-87.4,-93.54833418607217),
                new Scale(-87.3,-93.68795290533119),
                new Scale(-87.2,-93.82781859902067),
                new Scale(-87.1,-93.96793367949616),
                new Scale(-87,-94.10830006713971),
                new Scale(-86.9,-94.24891917056202),
                new Scale(-86.8,-94.38979251446874),
                new Scale(-86.7,-94.53092173704164),
                new Scale(-86.6,-94.67230924363403),
                new Scale(-86.5,-94.81395690310278),
                new Scale(-86.4,-94.95586602539395),
                new Scale(-86.3,-95.09803867510746),
                new Scale(-86.2,-95.24047634321064),
                new Scale(-86.1,-84.9351488296851),
                new Scale(-86,-84.80883877950043),
                new Scale(-85.9,-84.68269306673908),
                new Scale(-85.8,-84.55671078613173),
                new Scale(-85.7,-84.43089103944627),
                new Scale(-85.6,-84.30523293541376),
                new Scale(-85.5,-84.17973558962927),
                new Scale(-85.4,-84.05439820972502),
                new Scale(-85.3,-83.92921976250592),
                new Scale(-85.2,-83.80419954829543),
                new Scale(-85.1,-83.6793365486353),
                new Scale(-85,-83.55463007973373),
                new Scale(-84.9,-83.43007912994301),
                new Scale(-84.8,-83.30568303903215),
                new Scale(-84.7,-83.18144088864189),
                new Scale(-84.6,-83.0573518571129),
                new Scale(-84.5,-82.93341503966971),
                new Scale(-84.4,-82.80962980792604),
                new Scale(-84.3,-82.68599526707001),
                new Scale(-84.2,-82.56251062043513),
                new Scale(-84.1,-82.43917507745043),
                new Scale(-84,-82.31598785358328),
                new Scale(-83.9,-82.19294817027966),
                new Scale(-83.8,-82.070055254902),
                new Scale(-83.7,-81.94730834066587),
                new Scale(-83.6,-81.82470666657376),
                new Scale(-83.5,-81.70224947734772),
                new Scale(-83.4,-81.57993613052247),
                new Scale(-83.3,-81.45776567442037),
                new Scale(-83.2,-81.3357374722526),
                new Scale(-83.1,-81.21385079109362),
                new Scale(-83,-81.09210501119608),
                new Scale(-82.9,-80.97049920440858),
                new Scale(-82.8,-80.84903275359508),
                new Scale(-82.7,-80.72770494717199),
                new Scale(-82.6,-80.60651519692316),
                new Scale(-82.5,-80.48546257868),
                new Scale(-82.4,-80.36454650284789),
                new Scale(-82.3,-80.24376640241618),
                new Scale(-82.2,-80.12312135925792),
                new Scale(-82.1,-80.00261092063661),
                new Scale(-82,-79.88223419036109),
                new Scale(-81.9,-79.76199071538763),
                new Scale(-81.8,-79.6418796176421),
                new Scale(-81.7,-79.52190033441262),
                new Scale(-81.6,-79.40205234008856),
                new Scale(-81.5,-79.28233474057176),
                new Scale(-81.4,-79.16274713270731),
                new Scale(-81.3,-79.04328863160201),
                new Scale(-81.2,-78.92395884505723),
                new Scale(-81.1,-78.80475689376908),
                new Scale(-81,-78.68568239979899),
                new Scale(-80.9,-78.56673460576332),
                new Scale(-80.8,-78.44791279126594),
                new Scale(-80.7,-78.3292165632213),
                new Scale(-80.6,-78.21064508405506),
                new Scale(-80.5,-78.09219798118734),
                new Scale(-80.4,-77.97387441163677),
                new Scale(-80.3,-77.85567402721776),
                new Scale(-80.2,-77.73759610099714),
                new Scale(-80.1,-77.61963993574528),
                new Scale(-80,-77.50180517979972),
                new Scale(-79.9,-77.38409100673523),
                new Scale(-79.8,-77.26649709669162),
                new Scale(-79.7,-77.14902273888552),
                new Scale(-79.6,-77.03166724779678),
                new Scale(-79.5,-76.91443030815465),
                new Scale(-79.4,-76.79731122477335),
                new Scale(-79.3,-76.68030932432973),
                new Scale(-79.2,-76.56342430095064),
                new Scale(-79.1,-76.4466554719858),
                new Scale(-79,-76.33000217367992),
                new Scale(-78.9,-76.21346411422576),
                new Scale(-78.8,-76.0970406205444),
                new Scale(-78.7,-75.98073103574234),
                new Scale(-78.6,-75.86453508690951),
                new Scale(-78.5,-75.7484521075114),
                new Scale(-78.4,-75.63248144458443),
                new Scale(-78.3,-75.51662284942664),
                new Scale(-78.2,-75.40087565879088),
                new Scale(-78.1,-75.28523935855674),
                new Scale(-78,-75.16971331565743),
                new Scale(-77.9,-75.05429728118001),
                new Scale(-77.8,-74.93899061279036),
                new Scale(-77.7,-74.82379280960174),
                new Scale(-77.6,-74.70870325465356),
                new Scale(-77.5,-74.5937217054327),
                new Scale(-77.4,-74.47884753626474),
                new Scale(-77.3,-74.3640801248616),
                new Scale(-77.2,-74.24941926940272),
                new Scale(-77.1,-74.1348643372825),
                new Scale(-77,-74.02041484975172),
                new Scale(-76.9,-73.90607033105763),
                new Scale(-76.8,-73.7918301859082),
                new Scale(-76.7,-73.6776942027547),
                new Scale(-76.6,-73.56366177753878),
                new Scale(-76.5,-73.44973244643894),
                new Scale(-76.4,-73.33590561953885),
                new Scale(-76.3,-73.22218111029876),
                new Scale(-76.2,-73.10855831946475),
                new Scale(-76.1,-72.995036794744),
                new Scale(-76,-72.88161608662236),
                new Scale(-75.9,-72.76829562346617),
                new Scale(-75.8,-72.65507522389456),
                new Scale(-75.7,-72.54195430754214),
                new Scale(-75.6,-72.42893243594334),
                new Scale(-75.5,-72.31600903470233),
                new Scale(-75.4,-72.20318396180136),
                new Scale(-75.3,-72.09045663278822),
                new Scale(-75.2,-71.97782661987924),
                new Scale(-75.1,-71.8652934978655),
                new Scale(-75,-71.75285684409467),
                new Scale(-74.9,-71.64051611021269),
                new Scale(-74.8,-71.52827114772843),
                new Scale(-74.7,-71.41612139945914),
                new Scale(-74.6,-71.30406645290957),
                new Scale(-74.5,-71.19210589803633),
                new Scale(-74.4,-71.08023919127616),
                new Scale(-74.3,-70.96846621241856),
                new Scale(-74.2,-70.85678640840614),
                new Scale(-74.1,-70.74519937894044),
                new Scale(-74,-70.63370472607544),
                new Scale(-73.9,-70.52230205420005),
                new Scale(-73.8,-70.41099083546365),
                new Scale(-73.7,-70.29977096064971),
                new Scale(-73.6,-70.18864189266375),
                new Scale(-73.5,-70.07760324517042),
                new Scale(-73.4,-69.9666546340748),
                new Scale(-73.3,-69.85579567750582),
                new Scale(-73.2,-69.74502585796631),
                new Scale(-73.1,-69.63434508634366),
                new Scale(-73,-69.52375283567292),
                new Scale(-72.9,-69.41324873291794),
                new Scale(-72.8,-69.30283240717661),
                new Scale(-72.7,-69.19250348966568),
                new Scale(-72.6,-69.08226161370507),
                new Scale(-72.5,-68.97210628178674),
                new Scale(-72.4,-68.86203740923092),
                new Scale(-72.3,-68.75205448959332),
                new Scale(-72.2,-68.64215716454487),
                new Scale(-72.1,-68.53234507777547),
                new Scale(-72,-68.4226178749795),
                new Scale(-71.9,-68.31297520384112),
                new Scale(-71.8,-68.20341658093636),
                new Scale(-71.7,-68.09394193585864),
                new Scale(-71.6,-67.98455077626714),
                new Scale(-71.5,-67.87524275774653),
                new Scale(-71.4,-67.76601753779228),
                new Scale(-71.3,-67.65687477579668),
                new Scale(-71.2,-67.54781413303573),
                new Scale(-71.1,-67.4388351343981),
                new Scale(-71,-67.32993773345578),
                new Scale(-70.9,-67.22112144572138),
                new Scale(-70.8,-67.11238593995188),
                new Scale(-70.7,-67.00373088671337),
                new Scale(-70.6,-66.89515595836815),
                new Scale(-70.5,-66.78666082906189),
                new Scale(-70.4,-66.67824517471091),
                new Scale(-70.3,-66.56990853687473),
                new Scale(-70.2,-66.46165087892842),
                new Scale(-70.1,-66.35347173321034),
                new Scale(-70,-66.24537078267079),
                new Scale(-69.9,-66.13734771196167),
                new Scale(-69.8,-66.02940220742435),
                new Scale(-69.7,-65.92153395707786),
                new Scale(-69.6,-65.81374265060698),
                new Scale(-69.5,-65.70602784028009),
                new Scale(-69.4,-65.5983895090908),
                new Scale(-69.3,-65.49082719973808),
                new Scale(-69.2,-65.38334060852804),
                new Scale(-69.1,-65.27592943336796),
                new Scale(-69,-65.16859337375548),
                new Scale(-68.9,-65.06133213076731),
                new Scale(-68.8,-64.95414540704813),
                new Scale(-68.7,-64.84703290679995),
                new Scale(-68.6,-64.73999420117461),
                new Scale(-68.5,-64.63302927813994),
                new Scale(-68.4,-64.52613769948562),
                new Scale(-68.3,-64.41931917560473),
                new Scale(-68.2,-64.31257341838794),
                new Scale(-68.1,-64.2059001412133),
                new Scale(-68,-64.09929905893601),
                new Scale(-67.9,-63.99276988787808),
                new Scale(-67.8,-63.88631234581833),
                new Scale(-67.7,-63.77992601773892),
                new Scale(-67.6,-63.67361090435642),
                new Scale(-67.5,-63.56736658101747),
                new Scale(-67.4,-63.46119277129817),
                new Scale(-67.3,-63.35508920017643),
                new Scale(-67.2,-63.249055594022316),
                new Scale(-67.1,-63.14309168058875),
                new Scale(-67,-63.037197189002),
                new Scale(-66.9,-62.93137184975236),
                new Scale(-66.8,-62.82561525794773),
                new Scale(-66.7,-62.7199274323199),
                new Scale(-66.6,-62.61430795761878),
                new Scale(-66.5,-62.50875656977136),
                new Scale(-66.4,-62.403273006017535),
                new Scale(-66.3,-62.29785700490131),
                new Scale(-66.2,-62.19250830626225),
                new Scale(-66.1,-62.087226651226615),
                new Scale(-66,-61.98201178219911),
                new Scale(-65.9,-61.87686344285391),
                new Scale(-65.8,-61.77178125117574),
                new Scale(-65.7,-61.66676521917271),
                new Scale(-65.6,-61.56181495442768),
                new Scale(-65.5,-61.45693020568246),
                new Scale(-65.4,-61.352110722901195),
                new Scale(-65.3,-61.247356257262666),
                new Scale(-65.2,-61.14266656115209),
                new Scale(-65.1,-61.03804138815339),
                new Scale(-65,-60.93348049304139),
                new Scale(-64.9,-60.828983506996885),
                new Scale(-64.8,-60.72455044977768),
                new Scale(-64.7,-60.62018094072631),
                new Scale(-64.6,-60.51587473938624),
                new Scale(-64.5,-60.41163160644726),
                new Scale(-64.4,-60.30745130373836),
                new Scale(-64.3,-60.203333594220354),
                new Scale(-64.2,-60.099278241978865),
                new Scale(-64.1,-59.995284889614425),
                new Scale(-64,-59.89135356445166),
                new Scale(-63.9,-59.78748389409034),
                new Scale(-63.8,-59.6836756471489),
                new Scale(-63.7,-59.57992859332758),
                new Scale(-63.6,-59.476242503402034),
                new Scale(-63.5,-59.372617023910635),
                new Scale(-63.4,-59.269052201491256),
                new Scale(-63.3,-59.16554765952296),
                new Scale(-63.2,-59.06210317317713),
                new Scale(-63.1,-58.9587183959555),
                new Scale(-63,-58.855393392021476),
                new Scale(-62.9,-58.75212765188661),
                new Scale(-62.8,-58.64892121300364),
                new Scale(-62.7,-58.545773856582066),
                new Scale(-62.6,-58.44268501005074),
                new Scale(-62.5,-58.339654728160816),
                new Scale(-62.4,-58.23668273721398),
                new Scale(-62.3,-58.13376882166565),
                new Scale(-62.2,-58.03091276693722),
                new Scale(-62.1,-57.92811421488868),
                new Scale(-62,-57.8253732291896),
                new Scale(-61.9,-57.72268946812047),
                new Scale(-61.8,-57.62006272076579),
                new Scale(-61.7,-57.51749277715977),
                new Scale(-61.6,-57.41497942828042),
                new Scale(-61.5,-57.312522466043866),
                new Scale(-61.4,-57.210121683298524),
                new Scale(-61.3,-57.10777687381934),
                new Scale(-61.2,-57.00548783230207),
                new Scale(-61.1,-56.903254354357614),
                new Scale(-61,-56.801076236506354),
                new Scale(-60.9,-56.69895327617244),
                new Scale(-60.8,-56.59688527167826),
                new Scale(-60.7,-56.494872022238795),
                new Scale(-60.6,-56.39291332795605),
                new Scale(-60.5,-56.291008989813605),
                new Scale(-60.4,-56.189158809671014),
                new Scale(-60.3,-56.08736259025841),
                new Scale(-60.2,-55.98562013517108),
                new Scale(-60.1,-55.88393124886394),
                new Scale(-60,-55.78229573664632),
                new Scale(-59.9,-55.68071340467657),
                new Scale(-59.8,-55.579184059956596),
                new Scale(-59.7,-55.477707510326866),
                new Scale(-59.6,-55.376283564460934),
                new Scale(-59.5,-55.274912031860346),
                new Scale(-59.4,-55.173592722849435),
                new Scale(-59.3,-55.07232544857016),
                new Scale(-59.2,-54.971110020977015),
                new Scale(-59.1,-54.86994625283199),
                new Scale(-59,-54.76883395769938),
                new Scale(-58.9,-54.667772949941025),
                new Scale(-58.8,-54.5667630447111),
                new Scale(-58.7,-54.46580405795137),
                new Scale(-58.6,-54.3648959238442),
                new Scale(-58.5,-54.26403822056867),
                new Scale(-58.4,-54.163230888345005),
                new Scale(-58.3,-54.06247374622206),
                new Scale(-58.2,-53.96176661401109),
                new Scale(-58.1,-53.861109312281116),
                new Scale(-58,-53.76050166235425),
                new Scale(-57.9,-53.65994348630111),
                new Scale(-57.8,-53.55943460693625),
                new Scale(-57.7,-53.45897484781363),
                new Scale(-57.6,-53.35856403322193),
                new Scale(-57.5,-53.25820198818032),
                new Scale(-57.4,-53.15788853843381),
                new Scale(-57.3,-53.057623510448835),
                new Scale(-57.2,-52.95740673140889),
                new Scale(-57.1,-52.85723802921018),
                new Scale(-57,-52.75711723245715),
                new Scale(-56.9,-52.65704417045836),
                new Scale(-56.8,-52.557018673221975),
                new Scale(-56.7,-52.45704057145169),
                new Scale(-56.6,-52.35710969654236),
                new Scale(-56.5,-52.25722588057594),
                new Scale(-56.4,-52.157388956317185),
                new Scale(-56.3,-52.05759875720951),
                new Scale(-56.2,-51.957855117371025),
                new Scale(-56.1,-51.85815787159021),
                new Scale(-56,-51.75850685532207),
                new Scale(-55.9,-51.65890190468401),
                new Scale(-55.8,-51.559342856451785),
                new Scale(-55.7,-51.45982954805563),
                new Scale(-55.6,-51.36036192674397),
                new Scale(-55.5,-51.26093960752128),
                new Scale(-55.4,-51.161562544532025),
                new Scale(-55.3,-51.06223057777898),
                new Scale(-55.2,-50.96294354789986),
                new Scale(-55.1,-50.86370129616342),
                new Scale(-55,-50.764503664465884),
                new Scale(-54.9,-50.665350495327004),
                new Scale(-54.8,-50.56624163188655),
                new Scale(-54.7,-50.46717691790045),
                new Scale(-54.6,-50.368156197737186),
                new Scale(-54.5,-50.26917931637418),
                new Scale(-54.4,-50.17024611939415),
                new Scale(-54.3,-50.07135645298152),
                new Scale(-54.2,-49.9725101639189),
                new Scale(-54.1,-49.87370709958343),
                new Scale(-54,-49.77494710794339),
                new Scale(-53.9,-49.6762300375546),
                new Scale(-53.8,-49.5775557375571),
                new Scale(-53.7,-49.47892405767151),
                new Scale(-53.6,-49.380334848195716),
                new Scale(-53.5,-49.28178796000145),
                new Scale(-53.4,-49.183283244530955),
                new Scale(-53.3,-49.08482055379359),
                new Scale(-53.2,-48.98639974036249),
                new Scale(-53.1,-48.88802065737125),
                new Scale(-53,-48.78968315851072),
                new Scale(-52.9,-48.691387098025636),
                new Scale(-52.8,-48.593132330711484),
                new Scale(-52.7,-48.494918807164645),
                new Scale(-52.6,-48.396746187410756),
                new Scale(-52.5,-48.298614428749474),
                new Scale(-52.4,-48.20052338813646),
                new Scale(-52.3,-48.10247292306253),
                new Scale(-52.2,-48.00446289155046),
                new Scale(-52.1,-47.90649315215204),
                new Scale(-52,-47.80856356394488),
                new Scale(-51.9,-47.710673986529464),
                new Scale(-51.8,-47.61282428002608),
                new Scale(-51.7,-47.515014305071766),
                new Scale(-51.6,-47.41724392281744),
                new Scale(-51.5,-47.319512994924786),
                new Scale(-51.4,-47.221821383563494),
                new Scale(-51.3,-47.12416895140817),
                new Scale(-51.2,-47.02655556163552),
                new Scale(-51.1,-46.92898107792141),
                new Scale(-51,-46.83144536443804),
                new Scale(-50.9,-46.733948285851156),
                new Scale(-50.8,-46.63648970731705),
                new Scale(-50.7,-46.53906949447991),
                new Scale(-50.6,-46.44168751346897),
                new Scale(-50.5,-46.34434363089571),
                new Scale(-50.4,-46.24703771385118),
                new Scale(-50.3,-46.14976962990321),
                new Scale(-50.2,-46.05253924709369),
                new Scale(-50.1,-45.95534643393593),
                new Scale(-50,-45.8581910594119),
                new Scale(-49.9,-45.76107299296963),
                new Scale(-49.8,-45.66399218587767),
                new Scale(-49.7,-45.566948340686665),
                new Scale(-49.6,-45.46994141497539),
                new Scale(-49.5,-45.3729712800163),
                new Scale(-49.4,-45.276037807535275),
                new Scale(-49.3,-45.17914086970917),
                new Scale(-49.2,-45.08228033916329),
                new Scale(-49.1,-44.985456088968675),
                new Scale(-49,-44.88866799263985),
                new Scale(-48.9,-44.79191592413209),
                new Scale(-48.8,-44.69519975783905),
                new Scale(-48.7,-44.59851936859033),
                new Scale(-48.6,-44.50187463164887),
                new Scale(-48.5,-44.40526542270866),
                new Scale(-48.4,-44.30869161789228),
                new Scale(-48.3,-44.21215309374849),
                new Scale(-48.2,-44.11564972724979),
                new Scale(-48.1,-44.01918139579019),
                new Scale(-48,-43.92274797718264),
                new Scale(-47.9,-43.82634934965691),
                new Scale(-47.8,-43.72998539185714),
                new Scale(-47.7,-43.63365598283954),
                new Scale(-47.6,-43.5373610020701),
                new Scale(-47.5,-43.441100329422355),
                new Scale(-47.4,-43.344873845175044),
                new Scale(-47.3,-43.24868143000993),
                new Scale(-47.2,-43.15252296500953),
                new Scale(-47.1,-43.05639833165486),
                new Scale(-47,-42.960307411823365),
                new Scale(-46.9,-42.86425015664097),
                new Scale(-46.8,-42.76822630618212),
                new Scale(-46.7,-42.672235817540944),
                new Scale(-46.6,-42.57627857414178),
                new Scale(-46.5,-42.4803544597953),
                new Scale(-46.4,-42.38446335869617),
                new Scale(-46.3,-42.288605155421145),
                new Scale(-46.2,-42.19277973492674),
                new Scale(-46.1,-42.09698698254721),
                new Scale(-46,-42.00122678399259),
                new Scale(-45.9,-41.90549902534641),
                new Scale(-45.8,-41.809803593063705),
                new Scale(-45.7,-41.714140373969066),
                new Scale(-45.6,-41.61850925525443),
                new Scale(-45.5,-41.52291012447722),
                new Scale(-45.4,-41.427342869558196),
                new Scale(-45.3,-41.33180737877957),
                new Scale(-45.2,-41.236303540783005),
                new Scale(-45.1,-41.14083124456755),
                new Scale(-45,-41.04539037948777),
                new Scale(-44.9,-40.94998083525179),
                new Scale(-44.8,-40.854602501919345),
                new Scale(-44.7,-40.75925526989992),
                new Scale(-44.6,-40.66393902995068),
                new Scale(-44.5,-40.56865367317477),
                new Scale(-44.4,-40.473399091019324),
                new Scale(-44.3,-40.37817517527361),
                new Scale(-44.2,-40.282981818067185),
                new Scale(-44.1,-40.18781891186801),
                new Scale(-44,-40.09268634948066),
                new Scale(-43.9,-39.99758407527568),
                new Scale(-43.8,-39.90251187596772),
                new Scale(-43.7,-39.80746970120321),
                new Scale(-43.6,-39.712457445095026),
                new Scale(-43.5,-39.61747500208467),
                new Scale(-43.4,-39.522522266940484),
                new Scale(-43.3,-39.42759913475581),
                new Scale(-43.2,-39.33270550094722),
                new Scale(-43.1,-39.23784126125274),
                new Scale(-43,-39.14300631173018),
                new Scale(-42.9,-39.048200548755226),
                new Scale(-42.8,-38.95342386901983),
                new Scale(-42.7,-38.85867616953045),
                new Scale(-42.6,-38.76395734760625),
                new Scale(-42.5,-38.669267300877586),
                new Scale(-42.4,-38.574605927284125),
                new Scale(-42.3,-38.479973125073265),
                new Scale(-42.2,-38.38536879279845),
                new Scale(-42.1,-38.2907928293175),
                new Scale(-42,-38.19624513379098),
                new Scale(-41.9,-38.10172560568053),
                new Scale(-41.8,-38.00723414474727),
                new Scale(-41.7,-37.91277065105018),
                new Scale(-41.6,-37.8183350249445),
                new Scale(-41.5,-37.72392716708011),
                new Scale(-41.4,-37.62954697839996),
                new Scale(-41.3,-37.53519436013849),
                new Scale(-41.2,-37.44086921382012),
                new Scale(-41.1,-37.346571441257574),
                new Scale(-41,-37.25230097905009),
                new Scale(-40.9,-37.15805765690795),
                new Scale(-40.8,-37.06384141601418),
                new Scale(-40.7,-36.96965215929333),
                new Scale(-40.6,-36.87548978995241),
                new Scale(-40.5,-36.781354211479204),
                new Scale(-40.4,-36.68724532764075),
                new Scale(-40.3,-36.593163042481805),
                new Scale(-40.2,-36.49910726032335),
                new Scale(-40.1,-36.40507788576089),
                new Scale(-40,-36.311074823663176),
                new Scale(-39.9,-36.21709797917052),
                new Scale(-39.8,-36.123147257693375),
                new Scale(-39.7,-36.02922256491087),
                new Scale(-39.6,-35.935323806769254),
                new Scale(-39.5,-35.84145088948055),
                new Scale(-39.4,-35.74760371952099),
                new Scale(-39.3,-35.65378220362964),
                new Scale(-39.2,-35.559986248806965),
                new Scale(-39.1,-35.466215762313354),
                new Scale(-39,-35.37247065166783),
                new Scale(-38.9,-35.27875082464647),
                new Scale(-38.8,-35.18505618928119),
                new Scale(-38.7,-35.09138665385824),
                new Scale(-38.6,-34.9977421269169),
                new Scale(-38.5,-34.90412251724805),
                new Scale(-38.4,-34.8105277541063),
                new Scale(-38.3,-34.71695770325281),
                new Scale(-38.2,-34.62341229794514),
                new Scale(-38.1,-34.52989144792447),
                new Scale(-38,-34.43639506318041),
                new Scale(-37.9,-34.34292305394949),
                new Scale(-37.8,-34.24947533071369),
                new Scale(-37.7,-34.15605180419894),
                new Scale(-37.6,-34.06265238537369),
                new Scale(-37.5,-33.96927698544744),
                new Scale(-37.4,-33.87592551586943),
                new Scale(-37.3,-33.78259788832704),
                new Scale(-37.2,-33.68929401474453),
                new Scale(-37.1,-33.59601380728161),
                new Scale(-37,-33.50275717833204),
                new Scale(-36.9,-33.40952404052229),
                new Scale(-36.8,-33.31631430671023),
                new Scale(-36.7,-33.22312788998372),
                new Scale(-36.6,-33.1299647036593),
                new Scale(-36.5,-33.03682466128088),
                new Scale(-36.4,-32.943707676618516),
                new Scale(-36.3,-32.85061367075824),
                new Scale(-36.2,-32.75754254162368),
                new Scale(-36.1,-32.664494213382454),
                new Scale(-36,-32.571468600596205),
                new Scale(-35.9,-32.47846561805899),
                new Scale(-35.8,-32.38548518079535),
                new Scale(-35.7,-32.29252720405834),
                new Scale(-35.6,-32.19959160332766),
                new Scale(-35.5,-32.106678294307684),
                new Scale(-35.4,-32.013787192925605),
                new Scale(-35.3,-31.920918215329497),
                new Scale(-35.2,-31.828071278628624),
                new Scale(-35.1,-31.73524629719271),
                new Scale(-35,-31.642443190099037),
                new Scale(-34.9,-31.549661873247455),
                new Scale(-34.8,-31.456902262871967),
                new Scale(-34.7,-31.364164280912313),
                new Scale(-34.6,-31.271447840127824),
                new Scale(-34.5,-31.17875286004324),
                new Scale(-34.4,-31.08607925871165),
                new Scale(-34.3,-30.99342695438882),
                new Scale(-34.2,-30.90079586553145),
                new Scale(-34.1,-30.80818591079543),
                new Scale(-34,-30.715597009034184),
                new Scale(-33.9,-30.623029079296874),
                new Scale(-33.8,-30.530482040826808),
                new Scale(-33.7,-30.437955813059727),
                new Scale(-33.6,-30.345450315622106),
                new Scale(-33.5,-30.252965468329624),
                new Scale(-33.4,-30.160501191185453),
                new Scale(-33.3,-30.068057404378674),
                new Scale(-33.2,-29.975634028282688),
                new Scale(-33.1,-29.883230969937344),
                new Scale(-33,-29.790848175097686),
                new Scale(-32.9,-29.69848555311964),
                new Scale(-32.8,-29.60614302514329),
                new Scale(-32.7,-29.51382051249455),
                new Scale(-32.6,-29.421517936684193),
                new Scale(-32.5,-29.329235219407),
                new Scale(-32.4,-29.23697228254087),
                new Scale(-32.3,-29.144729048145866),
                new Scale(-32.2,-29.052505438463427),
                new Scale(-32.1,-28.960301375915463),
                new Scale(-32,-28.868116783103446),
                new Scale(-31.9,-28.775951582807636),
                new Scale(-31.8,-28.68380569798617),
                new Scale(-31.7,-28.591679072231166),
                new Scale(-31.6,-28.499571582791486),
                new Scale(-31.5,-28.407483177151512),
                new Scale(-31.4,-28.315413758766997),
                new Scale(-31.3,-28.22336331118165),
                new Scale(-31.2,-28.131331698199233),
                new Scale(-31.1,-28.039318902973267),
                new Scale(-31,-27.947324789512088),
                new Scale(-30.9,-27.855349306016922),
                new Scale(-30.8,-27.763392377179557),
                new Scale(-30.7,-27.67145392786072),
                new Scale(-30.6,-27.579533883089344),
                new Scale(-30.5,-27.48763216806174),
                new Scale(-30.4,-27.395748708140882),
                new Scale(-30.3,-27.303883428855595),
                new Scale(-30.2,-27.212036255899815),
                new Scale(-30.1,-27.120207115131823),
                new Scale(-30,-27.028395932573495),
                new Scale(-29.9,-26.93660263440958),
                new Scale(-29.8,-26.844827109180432),
                new Scale(-29.7,-26.753069352788838),
                new Scale(-29.6,-26.661329259560468),
                new Scale(-29.5,-26.56960675625726),
                new Scale(-29.4,-26.477901769796368),
                new Scale(-29.3,-26.38621422724924),
                new Scale(-29.2,-26.29454405584079),
                new Scale(-29.1,-26.202891182948573),
                new Scale(-29,-26.111255536101886),
                new Scale(-28.9,-26.01963704298096),
                new Scale(-28.8,-25.92803563141618),
                new Scale(-28.7,-25.836451229387077),
                new Scale(-28.6,-25.74488376502169),
                new Scale(-28.5,-25.653333166595623),
                new Scale(-28.4,-25.561799362531236),
                new Scale(-28.3,-25.470282281396848),
                new Scale(-28.2,-25.378781851905885),
                new Scale(-28.1,-25.28729800291609),
                new Scale(-28,-25.195830663428673),
                new Scale(-27.9,-25.104379762587556),
                new Scale(-27.8,-25.01294522967851),
                new Scale(-27.7,-24.92152699412838),
                new Scale(-27.6,-24.830124985504277),
                new Scale(-27.5,-24.738739133512773),
                new Scale(-27.4,-24.647369417397467),
                new Scale(-27.3,-24.556015673476494),
                new Scale(-27.2,-24.464677876572484),
                new Scale(-27.1,-24.373355956971047),
                new Scale(-27,-24.282049845094726),
                new Scale(-26.9,-24.190759471502297),
                new Scale(-26.8,-24.09948476688796),
                new Scale(-26.7,-24.00822566208068),
                new Scale(-26.6,-23.916982088043433),
                new Scale(-26.5,-23.825753975872463),
                new Scale(-26.4,-23.734541256796614),
                new Scale(-26.3,-23.643343862176543),
                new Scale(-26.2,-23.55216172350405),
                new Scale(-26.1,-23.46099477240137),
                new Scale(-26,-23.369842940620444),
                new Scale(-25.9,-23.278706160042223),
                new Scale(-25.8,-23.18758436267597),
                new Scale(-25.7,-23.096477480658553),
                new Scale(-25.6,-23.00538544625375),
                new Scale(-25.5,-22.914308191851582),
                new Scale(-25.4,-22.823245649967564),
                new Scale(-25.3,-22.732197753242108),
                new Scale(-25.2,-22.641164434439727),
                new Scale(-25.1,-22.55014562644847),
                new Scale(-25,-22.459141262279147),
                new Scale(-24.9,-22.36815127506473),
                new Scale(-24.8,-22.2771755980596),
                new Scale(-24.7,-22.18621416463898),
                new Scale(-24.6,-22.09526690829817),
                new Scale(-24.5,-22.00433376265194),
                new Scale(-24.4,-21.913414661433855),
                new Scale(-24.3,-21.82250946834321),
                new Scale(-24.2,-21.731618252287486),
                new Scale(-24.1,-21.64074088222255),
                new Scale(-24,-21.54987729233285),
                new Scale(-23.9,-21.459027416917642),
                new Scale(-23.8,-21.368191190390398),
                new Scale(-23.7,-21.27736854727808),
                new Scale(-23.6,-21.186559422220558),
                new Scale(-23.5,-21.095763749969898),
                new Scale(-23.4,-21.004981465389747),
                new Scale(-23.3,-20.914212503454664),
                new Scale(-23.2,-20.823456799249474),
                new Scale(-23.1,-20.73271428796864),
                new Scale(-23,-20.641984904915592),
                new Scale(-22.9,-20.551268585502147),
                new Scale(-22.8,-20.460565265247794),
                new Scale(-22.7,-20.369874879779104),
                new Scale(-22.6,-20.279197364829116),
                new Scale(-22.5,-20.188532656236678),
                new Scale(-22.4,-20.097880689945786),
                new Scale(-22.3,-20.007241402005068),
                new Scale(-22.2,-19.91661472856705),
                new Scale(-22.1,-19.82600060588759),
                new Scale(-22,-19.73539897032524),
                new Scale(-21.9,-19.644809758340653),
                new Scale(-21.8,-19.554232906495955),
                new Scale(-21.7,-19.463668351454135),
                new Scale(-21.6,-19.373116029978444),
                new Scale(-21.5,-19.28257587893177),
                new Scale(-21.4,-19.192047835276043),
                new Scale(-21.3,-19.10153183607167),
                new Scale(-21.2,-19.011027818476844),
                new Scale(-21.1,-18.920535719747075),
                new Scale(-21,-18.83005547723447),
                new Scale(-20.9,-18.739587118247332),
                new Scale(-20.8,-18.649130406084716),
                new Scale(-20.7,-18.558685363050834),
                new Scale(-20.6,-18.468251926890087),
                new Scale(-20.5,-18.377830035440905),
                new Scale(-20.4,-18.287419626635206),
                new Scale(-20.3,-18.197020638497786),
                new Scale(-20.2,-18.106633009145778),
                new Scale(-20.1,-18.016256676788057),
                new Scale(-20,-17.925891579724667),
                new Scale(-19.9,-17.835537656346293),
                new Scale(-19.8,-17.74519484513364),
                new Scale(-19.7,-17.6548630846569),
                new Scale(-19.6,-17.564542313575192),
                new Scale(-19.5,-17.474232470635982),
                new Scale(-19.4,-17.38393349467456),
                new Scale(-19.3,-17.293645324613443),
                new Scale(-19.2,-17.20336789946182),
                new Scale(-19.1,-17.113101158315065),
                new Scale(-19,-17.022845040354092),
                new Scale(-18.9,-16.932599484844868),
                new Scale(-18.8,-16.84236443113787),
                new Scale(-18.7,-16.752139818667462),
                new Scale(-18.6,-16.661925586951458),
                new Scale(-18.5,-16.571721675590496),
                new Scale(-18.4,-16.481528024267533),
                new Scale(-18.3,-16.39134457274733),
                new Scale(-18.2,-16.30117126087583),
                new Scale(-18.1,-16.21100802857973),
                new Scale(-18,-16.120854815865844),
                new Scale(-17.9,-16.030711562820656),
                new Scale(-17.8,-15.94057820960974),
                new Scale(-17.7,-15.850454696477232),
                new Scale(-17.6,-15.760340963745328),
                new Scale(-17.5,-15.67023695181371),
                new Scale(-17.4,-15.580142601159089),
                new Scale(-17.3,-15.490057852334612),
                new Scale(-17.2,-15.399982533617445),
                new Scale(-17.1,-15.309916804823274),
                new Scale(-17,-15.219860499740571),
                new Scale(-16.9,-15.129813559215775),
                new Scale(-16.8,-15.039775924169055),
                new Scale(-16.7,-14.949747535593781),
                new Scale(-16.6,-14.859728334556053),
                new Scale(-16.5,-14.769718262194118),
                new Scale(-16.4,-14.679717259717965),
                new Scale(-16.3,-14.589725268408717),
                new Scale(-16.2,-14.499742229618153),
                new Scale(-16.1,-14.409768084768244),
                new Scale(-16,-14.319802775350608),
                new Scale(-15.9,-14.229846242926017),
                new Scale(-15.8,-14.139898429123912),
                new Scale(-15.7,-14.049959275641875),
                new Scale(-15.6,-13.96002872424516),
                new Scale(-15.5,-13.870106716766177),
                new Scale(-15.4,-13.78019319510402),
                new Scale(-15.3,-13.690288101223938),
                new Scale(-15.2,-13.600391377156884),
                new Scale(-15.1,-13.510502964998997),
                new Scale(-15,-13.420622806911119),
                new Scale(-14.9,-13.330750845118324),
                new Scale(-14.8,-13.240887021909401),
                new Scale(-14.7,-13.151031279636394),
                new Scale(-14.6,-13.061183560714113),
                new Scale(-14.5,-12.97134380761966),
                new Scale(-14.4,-12.881511962891913),
                new Scale(-14.3,-12.791687969131097),
                new Scale(-14.2,-12.701871768998279),
                new Scale(-14.1,-12.612063305214887),
                new Scale(-14,-12.522262520562247),
                new Scale(-13.9,-12.432469357881102),
                new Scale(-13.8,-12.34268376007115),
                new Scale(-13.7,-12.252905670090554),
                new Scale(-13.6,-12.163135030955496),
                new Scale(-13.5,-12.073371785739694),
                new Scale(-13.4,-11.983615877573936),
                new Scale(-13.3,-11.893867380490079),
                new Scale(-13.2,-11.804125981352865),
                new Scale(-13.1,-11.71439174916681),
                new Scale(-13,-11.6246646272899),
                new Scale(-12.9,-11.534944559134862),
                new Scale(-12.8,-11.445231488168714),
                new Scale(-12.7,-11.355525357912278),
                new Scale(-12.6,-11.265826111939742),
                new Scale(-12.5,-11.17613369387819),
                new Scale(-12.4,-11.086448047407123),
                new Scale(-12.3,-10.996769116258031),
                new Scale(-12.2,-10.907096844213912),
                new Scale(-12.1,-10.81743117510883),
                new Scale(-12,-10.727772052827445),
                new Scale(-11.9,-10.638119421304566),
                new Scale(-11.8,-10.548473224524693),
                new Scale(-11.7,-10.458833406521572),
                new Scale(-11.6,-10.369199911377718),
                new Scale(-11.5,-10.279572683223996),
                new Scale(-11.4,-10.189951666239157),
                new Scale(-11.3,-10.100336804649361),
                new Scale(-11.2,-10.010728042727777),
                new Scale(-11.1,-9.9211253247941),
                new Scale(-11,-9.831528595214113),
                new Scale(-10.9,-9.741937798399244),
                new Scale(-10.8,-9.652352878806104),
                new Scale(-10.7,-9.56277378093607),
                new Scale(-10.6,-9.47320044933481),
                new Scale(-10.5,-9.383632828591876),
                new Scale(-10.4,-9.294070863340211),
                new Scale(-10.3,-9.20451449825576),
                new Scale(-10.2,-9.11496367805699),
                new Scale(-10.1,-9.025418347504466),
                new Scale(-10,-8.935878451400411),
                new Scale(-9.9,-8.84634393458827),
                new Scale(-9.8,-8.75681474195226),
                new Scale(-9.7,-8.667290818416928),
                new Scale(-9.6,-8.577772108946748),
                new Scale(-9.5,-8.488258558545645),
                new Scale(-9.4,-8.398750112256579),
                new Scale(-9.3,-8.309246715161098),
                new Scale(-9.2,-8.219748312378934),
                new Scale(-9.1,-8.130254849067523),
                new Scale(-9,-8.04076627042161),
                new Scale(-8.9,-7.9512825216728),
                new Scale(-8.8,-7.861803394137334),
                new Scale(-8.7,-7.772329136445527),
                new Scale(-8.6,-7.682859544480484),
                new Scale(-8.5,-7.5933945636179745),
                new Scale(-8.4,-7.503934139268634),
                new Scale(-8.3,-7.41447821687753),
                new Scale(-8.2,-7.325026741923773),
                new Scale(-8.1,-7.23557965992007),
                new Scale(-8,-7.146136916412307),
                new Scale(-7.9,-7.056698456979148),
                new Scale(-7.8,-6.967264227231593),
                new Scale(-7.7,-6.877834172812582),
                new Scale(-7.6,-6.788408239396562),
                new Scale(-7.5,-6.698986372689073),
                new Scale(-7.4,-6.609568518426347),
                new Scale(-7.3,-6.520154622374872),
                new Scale(-7.2,-6.430744630330996),
                new Scale(-7.1,-6.3413384881204955),
                new Scale(-7,-6.251936141598183),
                new Scale(-6.9,-6.16253753664748),
                new Scale(-6.8,-6.073142619180004),
                new Scale(-6.7,-5.983751335135172),
                new Scale(-6.6,-5.894363630479773),
                new Scale(-6.5,-5.804979451207571),
                new Scale(-6.4,-5.715598743338889),
                new Scale(-6.3,-5.626221452920196),
                new Scale(-6.2,-5.536847526023713),
                new Scale(-6.1,-5.4474769087469905),
                new Scale(-6,-5.358109547212514),
                new Scale(-5.9,-5.268745387567283),
                new Scale(-5.8,-5.179384375982421),
                new Scale(-5.7,-5.090026458652753),
                new Scale(-5.6,-5.00067158179642),
                new Scale(-5.5,-4.911319691654459),
                new Scale(-5.4,-4.821970734490407),
                new Scale(-5.3,-4.732624656589887),
                new Scale(-5.2,-4.6432814042602235),
                new Scale(-5.1,-4.553940923830024),
                new Scale(-5,-4.464603161648782),
                new Scale(-4.9,-4.37526806408648),
                new Scale(-4.8,-4.285935577533179),
                new Scale(-4.7,-4.196605648398629),
                new Scale(-4.6,-4.107278223111856),
                new Scale(-4.5,-4.017953248120776),
                new Scale(-4.4,-3.9286306698917848),
                new Scale(-4.3,-3.8393104349093647),
                new Scale(-4.2,-3.7499924896756824),
                new Scale(-4.1,-3.6606767807101925),
                new Scale(-4,-3.571363254549244),
                new Scale(-3.9,-3.4820518577456747),
                new Scale(-3.8,-3.392742536868418),
                new Scale(-3.7,-3.3034352385021077),
                new Scale(-3.6,-3.2141299092466795),
                new Scale(-3.5,-3.124826495716976),
                new Scale(-3.4,-3.0355249445423493),
                new Scale(-3.3,-2.9462252023662687),
                new Scale(-3.2,-2.856927215845921),
                new Scale(-3.1,-2.7676309316518193),
                new Scale(-3,-2.6783362964674073),
                new Scale(-2.9,-2.5890432569886666),
                new Scale(-2.8,-2.4997517599237162),
                new Scale(-2.7,-2.41046175199243),
                new Scale(-2.6,-2.3211731799260304),
                new Scale(-2.5,-2.231885990466704),
                new Scale(-2.4,-2.1426001303672075),
                new Scale(-2.3,-2.053315546390468),
                new Scale(-2.2,-1.9640321853092009),
                new Scale(-2.1,-1.8747499939055077),
                new Scale(-2,-1.7854689189704849),
                new Scale(-1.9,-1.696188907303841),
                new Scale(-1.8,-1.6069099057134937),
                new Scale(-1.7,-1.5176318610151807),
                new Scale(-1.6,-1.4283547200320719),
                new Scale(-1.5,-1.3390784295943712),
                new Scale(-1.4,-1.2498029365389318),
                new Scale(-1.3,-1.1605281877088593),
                new Scale(-1.2,-1.0712541299531217),
                new Scale(-1.1,-0.9819807101261597),
                new Scale(-1,-0.892707875087492),
                new Scale(-0.9,-0.8034355717013278),
                new Scale(-0.8,-0.7141637468361722),
                new Scale(-0.7,-0.6248923473644364),
                new Scale(-0.6,-0.5356214875075891),
                new Scale(-0.5,-0.44635075545946873),
                new Scale(-0.4,-0.35708028795436647),
                new Scale(-0.3,-0.26781003182362756),
                new Scale(-0.2,-0.1785397464167533),
                new Scale(-0.1,-0.0892698449051827),
                new Scale(0,0),
                new Scale(0.1,0.08926984132217343),
                new Scale(0.2,0.17853993908697913),
                new Scale(0.3,0.26781004349895793),
                new Scale(0.4,0.35708030871841423),
                new Scale(0.5,0.4463507879191698),
                new Scale(0.6,0.5356213033332661),
                new Scale(0.7,0.6248923244383346),
                new Scale(0.8,0.7141637168613486),
                new Scale(0.9,0.8034355337206696),
                new Scale(1,0.8927078281374166),
                new Scale(1.1,0.9819806532358618),
                new Scale(1.2,1.0712540621438222),
                new Scale(1.3,1.1605283128509731),
                new Scale(1.4,1.2498030705900987),
                new Scale(1.5,1.3390785725569947),
                new Scale(1.6,1.4283548719289554),
                new Scale(1.7,1.5176320218894068),
                new Scale(1.8,1.6069100756283046),
                new Scale(1.9,1.696189086342531),
                new Scale(2,1.785469107236295),
                new Scale(2.1,1.874750191521525),
                new Scale(2.2,1.9640323924182714),
                new Scale(2.3,2.053315763155105),
                new Scale(2.4,2.1426003569695093),
                new Scale(2.5,2.2318862271082853),
                new Scale(2.6,2.3211732246511665),
                new Scale(2.7,2.410461793656495),
                new Scale(2.8,2.4997517982242545),
                new Scale(2.9,2.589043291626061),
                new Scale(3,2.6783363271445335),
                new Scale(3.1,2.767630958073704),
                new Scale(3.2,2.8569272377194066),
                new Scale(3.3,2.9462252193996847),
                new Scale(3.4,3.0355249564451823),
                new Scale(3.5,3.124826502199552),
                new Scale(3.6,3.2141299100198473),
                new Scale(3.7,3.303435233276928),
                new Scale(3.8,3.3927425253558545),
                new Scale(3.9,3.482051839656302),
                new Scale(4,3.571363229592945),
                new Scale(4.1,3.6606767485958707),
                new Scale(4.2,3.7499924501109763),
                new Scale(4.3,3.8393103876003734),
                new Scale(4.4,3.928630614542786),
                new Scale(4.5,4.017953392101951),
                new Scale(4.6,4.107278368719102),
                new Scale(4.7,4.196605795696217),
                new Scale(4.8,4.2859357265919105),
                new Scale(4.9,4.3752682149835636),
                new Scale(5,4.464603314467724),
                new Scale(5.1,4.553941078660524),
                new Scale(5.2,4.643281561198068),
                new Scale(5.3,4.73262481573684),
                new Scale(5.4,4.8219708959541245),
                new Scale(5.5,4.9113198555483875),
                new Scale(5.6,5.000671748239707),
                new Scale(5.7,5.090026627770161),
                new Scale(5.8,5.17938454790424),
                new Scale(5.9,5.268745562429256),
                new Scale(6,5.358109725155751),
                new Scale(6.1,5.447477089917893),
                new Scale(6.2,5.5368477105739045),
                new Scale(6.3,5.626221641006451),
                new Scale(6.4,5.715598935123058),
                new Scale(6.5,5.804979646856526),
                new Scale(6.6,5.894363830165332),
                new Scale(6.7,5.983751539034048),
                new Scale(6.8,6.073142827473734),
                new Scale(6.9,6.162537533068727),
                new Scale(7,6.251936134233109),
                new Scale(7.1,6.341338476907683),
                new Scale(7.2,6.430744615208372),
                new Scale(7.3,6.520154603279624),
                new Scale(7.4,6.609568495294847),
                new Scale(7.5,6.698986345456786),
                new Scale(7.6,6.788408207997986),
                new Scale(7.7,6.877834137181172),
                new Scale(7.8,6.9672641872996905),
                new Scale(7.9,7.056698412677919),
                new Scale(8,7.146136867671686),
                new Scale(8.1,7.235579606668696),
                new Scale(8.2,7.325026684088939),
                new Scale(8.3,7.414478154385136),
                new Scale(8.4,7.5039340720431245),
                new Scale(8.5,7.593394491582315),
                new Scale(8.6,7.682859467556102),
                new Scale(8.7,7.772329054552284),
                new Scale(8.8,7.861803307193487),
                new Scale(8.9,7.9512822801376055),
                new Scale(9,8.040766028078217),
                new Scale(9.1,8.130254605745002),
                new Scale(9.2,8.219748067904188),
                new Scale(9.3,8.309246469358973),
                new Scale(9.4,8.398749864949947),
                new Scale(9.5,8.48825830955553),
                new Scale(9.6,8.577771858092396),
                new Scale(9.7,8.667290565515922),
                new Scale(9.8,8.756814716797496),
                new Scale(9.9,8.846343914408683),
                new Scale(10,8.935878436185467),
                new Scale(10.1,9.025418337244625),
                new Scale(10.2,9.114963672743764),
                new Scale(10.3,9.204514497881766),
                new Scale(10.4,9.294070867899201),
                new Scale(10.5,9.383632838078787),
                new Scale(10.6,9.47320046374581),
                new Scale(10.7,9.56277380026857),
                new Scale(10.8,9.652352903058809),
                new Scale(10.9,9.74193782757216),
                new Scale(11,9.831528629308595),
                new Scale(11.1,9.92112536381283),
                new Scale(11.2,10.010728086674817),
                new Scale(11.3,10.100336853530143),
                new Scale(11.4,10.189951720060504),
                new Scale(11.5,10.279572741994125),
                new Scale(11.6,10.369199975106227),
                new Scale(11.7,10.45883347521945),
                new Scale(11.8,10.548473298204335),
                new Scale(11.9,10.63811949997972),
                new Scale(12,10.727772136513252),
                new Scale(12.1,10.817431263821781),
                new Scale(12.2,10.907096937971847),
                new Scale(12.3,10.996769215080105),
                new Scale(12.4,11.086448151313807),
                new Scale(12.5,11.17613380289123),
                new Scale(12.6,11.265826226082146),
                new Scale(12.7,11.355525477208282),
                new Scale(12.8,11.44523161264376),
                new Scale(12.9,11.534944688815562),
                new Scale(13,11.624664762203988),
                new Scale(13.1,11.7143916555686),
                new Scale(13.2,11.804125887093216),
                new Scale(13.3,11.893867285500628),
                new Scale(13.4,11.983615907488941),
                new Scale(13.5,12.073371809811952),
                new Scale(13.6,12.163135049279603),
                new Scale(13.7,12.252905682758454),
                new Scale(13.8,12.342683767172172),
                new Scale(13.9,12.432469359501962),
                new Scale(14,12.522262516787084),
                new Scale(14.1,12.612063296125283),
                new Scale(14.2,12.701871754673304),
                new Scale(14.3,12.791687949647331),
                new Scale(14.4,12.881511938323484),
                new Scale(14.5,12.97134377803829),
                new Scale(14.6,13.06118352618916),
                new Scale(14.7,13.151031240234879),
                new Scale(14.8,13.240886977696077),
                new Scale(14.9,13.330750796155721),
                new Scale(15,13.420622753259574),
                new Scale(15.1,13.510502906716713),
                new Scale(15.2,13.600391314300003),
                new Scale(15.3,13.690288033846572),
                new Scale(15.4,13.78019312325831),
                new Scale(15.5,13.870106640502375),
                new Scale(15.6,13.960028643611649),
                new Scale(15.7,14.049959190685259),
                new Scale(15.8,14.139898339889054),
                new Scale(15.9,14.229846149456124),
                new Scale(16,14.319802677687278),
                new Scale(16.1,14.409767982951529),
                new Scale(16.2,14.499742123686632),
                new Scale(16.3,14.589725158399544),
                new Scale(16.4,14.679717145666958),
                new Scale(16.5,14.76971814413579),
                new Scale(16.6,14.859728212523704),
                new Scale(16.7,14.949747409619565),
                new Scale(16.8,15.039775794284028),
                new Scale(16.9,15.129813425449974),
                new Scale(17,15.219860362123061),
                new Scale(17.1,15.309916663382248),
                new Scale(17.2,15.39998238838025),
                new Scale(17.3,15.490057596344128),
                new Scale(17.4,15.580142585924365),
                new Scale(17.5,15.670236941913656),
                new Scale(17.6,15.760340959021239),
                new Scale(17.7,15.850454696775271),
                new Scale(17.8,15.940578214780759),
                new Scale(17.9,16.030711572720108),
                new Scale(18,16.120854830353647),
                new Scale(18.1,16.21100804752018),
                new Scale(18.2,16.30117128413749),
                new Scale(18.3,16.39134460020284),
                new Scale(18.4,16.48152805579359),
                new Scale(18.5,16.57172171106767),
                new Scale(18.6,16.661925626264114),
                new Scale(18.7,16.752139861703625),
                new Scale(18.8,16.842364477789122),
                new Scale(18.9,16.932599535006243),
                new Scale(19,17.022845093923927),
                new Scale(19.1,17.11310121519493),
                new Scale(19.2,17.203367959556417),
                new Scale(19.3,17.29364538783043),
                new Scale(19.4,17.383933560924532),
                new Scale(19.5,17.474232539832308),
                new Scale(19.6,17.56454238563392),
                new Scale(19.7,17.654863159496678),
                new Scale(19.8,17.745194922675584),
                new Scale(19.9,17.835537736513928),
                new Scale(20,17.925891662443778),
                new Scale(20.1,18.01625676198665),
                new Scale(20.2,18.106633096753935),
                new Scale(20.3,18.197020728447605),
                new Scale(20.4,18.28741971886071),
                new Scale(20.5,18.377830129877957),
                new Scale(20.6,18.46825202347629),
                new Scale(20.7,18.55868546172544),
                new Scale(20.8,18.64913050678858),
                new Scale(20.9,18.7395872209228),
                new Scale(21,18.830055666479783),
                new Scale(21.1,18.92053590590632),
                new Scale(21.2,19.011028001744908),
                new Scale(21.3,19.101532016634422),
                new Scale(21.4,19.192048013310558),
                new Scale(21.5,19.282576054606555),
                new Scale(21.6,19.37311620345369),
                new Scale(21.7,19.46366852288196),
                new Scale(21.8,19.554233076020633),
                new Scale(21.9,19.64480992609887),
                new Scale(22,19.7353991364463),
                new Scale(22.1,19.826000770493625),
                new Scale(22.2,19.916614891773282),
                new Scale(22.3,20.00724156391999),
                new Scale(22.4,20.097880850671398),
                new Scale(22.5,20.188532815868687),
                new Scale(22.6,20.279197523457164),
                new Scale(22.7,20.369875037486946),
                new Scale(22.8,20.460565422113504),
                new Scale(22.9,20.55126874159832),
                new Scale(23,20.64198506030956),
                new Scale(23.1,20.732714442722596),
                new Scale(23.2,20.823456953420735),
                new Scale(23.3,20.914212657095792),
                new Scale(23.4,21.004981618548758),
                new Scale(23.5,21.095763902690425),
                new Scale(23.6,21.186559574542024),
                new Scale(23.7,21.277368699235872),
                new Scale(23.8,21.36819134201601),
                new Scale(23.9,21.459027568238877),
                new Scale(24,21.549877443373912),
                new Scale(24.1,21.640741033004243),
                new Scale(24.2,21.731618402827344),
                new Scale(24.3,21.822509618655666),
                new Scale(24.4,21.91341474641731),
                new Scale(24.5,22.00433385215671),
                new Scale(24.6,22.095267002035285),
                new Scale(24.7,22.186214262332065),
                new Scale(24.8,22.27717569944443),
                new Scale(24.9,22.368151379888758),
                new Scale(25,22.459141370301072),
                new Scale(25.1,22.550145737437756),
                new Scale(25.2,22.641164548176217),
                new Scale(25.3,22.732197869515602),
                new Scale(25.4,22.82324576857741),
                new Scale(25.5,22.914308312606263),
                new Scale(25.6,23.005385568970564),
                new Scale(25.7,23.096477605163187),
                new Scale(25.8,23.187584488802177),
                new Scale(25.9,23.27870628763144),
                new Scale(26,23.369843069521526),
                new Scale(26.1,23.46099490247021),
                new Scale(26.2,23.552161854603277),
                new Scale(26.3,23.64334399417524),
                new Scale(26.4,23.73454138957003),
                new Scale(26.5,23.825754109301702),
                new Scale(26.6,23.916982222015207),
                new Scale(26.7,24.00822579648707),
                new Scale(26.8,24.099484901626145),
                new Scale(26.9,24.190759606474305),
                new Scale(27,24.28204998020723),
                new Scale(27.1,24.373356092135154),
                new Scale(27.2,24.464678011703477),
                new Scale(27.3,24.556015808493697),
                new Scale(27.4,24.647369552223985),
                new Scale(27.5,24.738739312750074),
                new Scale(27.6,24.83012516006591),
                new Scale(27.7,24.921527164304443),
                new Scale(27.8,25.012945395738413),
                new Scale(27.9,25.10437992478107),
                new Scale(28,25.195830821986956),
                new Scale(28.1,25.2872981580527),
                new Scale(28.2,25.378782003817747),
                new Scale(28.3,25.470282430265136),
                new Scale(28.4,25.561799508522345),
                new Scale(28.5,25.653333309861992),
                new Scale(28.6,25.744883905702654),
                new Scale(28.7,25.83645136760967),
                new Scale(28.8,25.928035767295906),
                new Scale(28.9,26.019637176622588),
                new Scale(29,26.111255667600087),
                new Scale(29.1,26.202891312388676),
                new Scale(29.2,26.2945441832994),
                new Scale(29.3,26.386214352794887),
                new Scale(29.4,26.47790189349011),
                new Scale(29.5,26.569606878153262),
                new Scale(29.6,26.661329379706526),
                new Scale(29.7,26.753069471226944),
                new Scale(29.8,26.84482722594722),
                new Scale(29.9,26.93660271725658),
                new Scale(30,27.02839601870158),
                new Scale(30.1,27.120207203986958),
                new Scale(30.2,27.212036346976475),
                new Scale(30.3,27.3038835216938),
                new Scale(30.4,27.395748802323265),
                new Scale(30.5,27.487632263210884),
                new Scale(30.6,27.57953397886503),
                new Scale(30.7,27.671454023957416),
                new Scale(30.8,27.76339247332397),
                new Scale(30.9,27.85534940196562),
                new Scale(31,27.94732488504926),
                new Scale(31.1,28.03931899790857),
                new Scale(31.2,28.13133181604496),
                new Scale(31.3,28.223363415128386),
                new Scale(31.4,28.3154138709983),
                new Scale(31.5,28.407483259664545),
                new Scale(31.6,28.499571657308223),
                new Scale(31.7,28.59167914028262),
                new Scale(31.8,28.683805785114124),
                new Scale(31.9,28.77595166850316),
                new Scale(32,28.86811686732504),
                new Scale(32.1,28.96030145863096),
                new Scale(32.2,29.052505519648882),
                new Scale(32.3,29.14472912778451),
                new Scale(32.4,29.236972360622175),
                new Scale(32.5,29.329235295925816),
                new Scale(32.6,29.421518011639918),
                new Scale(32.7,29.513820585890468),
                new Scale(32.8,29.606143096985875),
                new Scale(32.9,29.698485623418005),
                new Scale(33,29.790848243863035),
                new Scale(33.1,29.8832308054954),
                new Scale(33.2,29.97563385558676),
                new Scale(33.3,30.06805723681141),
                new Scale(33.4,30.160501028590588),
                new Scale(33.5,30.2529653105349),
                new Scale(33.6,30.345450162445278),
                new Scale(33.7,30.437955664313954),
                new Scale(33.8,30.53048189632545),
                new Scale(33.9,30.623028938857733),
                new Scale(34,30.715596872483022),
                new Scale(34.1,30.808185777968998),
                new Scale(34.2,30.900795736279683),
                new Scale(34.3,30.99342682857657),
                new Scale(34.4,31.0860791362196),
                new Scale(34.5,31.17875274076828),
                new Scale(34.6,31.271447723982618),
                new Scale(34.7,31.364164167824264),
                new Scale(34.8,31.456902154457566),
                new Scale(34.9,31.549661766250555),
                new Scale(35,31.642443085776137),
                new Scale(35.1,31.735246195813023),
                new Scale(35.2,31.828071179346935),
                new Scale(35.3,31.920918119571617),
                new Scale(35.4,32.01378709988995),
                new Scale(35.5,32.10667820391507),
                new Scale(35.6,32.199591515471376),
                new Scale(35.7,32.2925271185958),
                new Scale(35.8,32.385485097538755),
                new Scale(35.9,32.478465536765356),
                new Scale(36,32.57146852095654),
                new Scale(36.1,32.66449413501011),
                new Scale(36.2,32.757542464041975),
                new Scale(36.3,32.850613593387216),
                new Scale(36.4,32.943707608601336),
                new Scale(36.5,33.03682459546125),
                new Scale(36.6,33.129964639966644),
                new Scale(36.7,33.22312804751802),
                new Scale(36.8,33.31631445882945),
                new Scale(36.9,33.40952418728388),
                new Scale(37,33.50275731978372),
                new Scale(37.1,33.596013943459866),
                new Scale(37.2,33.68929414567282),
                new Scale(37.3,33.78259801401393),
                new Scale(37.4,33.87592563630659),
                new Scale(37.5,33.96927710060743),
                new Scale(37.6,34.06265249520762),
                new Scale(37.7,34.15605190863403),
                new Scale(37.8,34.249475429650495),
                new Scale(37.9,34.34292314725905),
                new Scale(38,34.4363951507012),
                new Scale(38.1,34.52989152945919),
                new Scale(38.2,34.623412373257246),
                new Scale(38.3,34.71695777206283),
                new Scale(38.4,34.81052781608799),
                new Scale(38.5,34.90412259579061),
                new Scale(38.6,34.99774220187567),
                new Scale(38.7,35.09138672529659),
                new Scale(38.8,35.18505625725652),
                new Scale(38.9,35.27875088920974),
                new Scale(39,35.37247071286282),
                new Scale(39.1,35.46621582017607),
                new Scale(39.2,35.55998630336489),
                new Scale(39.3,35.653782050191246),
                new Scale(39.4,35.74760357223619),
                new Scale(39.5,35.84145074804395),
                new Scale(39.6,35.93532367086797),
                new Scale(39.7,36.029222434223755),
                new Scale(39.8,36.12314713189011),
                new Scale(39.9,36.217097857910645),
                new Scale(40,36.31107470659509),
                new Scale(40.1,36.40507777252081),
                new Scale(40.2,36.49910715053402),
                new Scale(40.3,36.59316293575139),
                new Scale(40.4,36.68724522356137),
                new Scale(40.5,36.781354109625646),
                new Scale(40.6,36.875489689880574),
                new Scale(40.7,36.96965206053862),
                new Scale(40.8,37.06384131808983),
                new Scale(40.9,37.15805755930329),
                new Scale(41,37.2523008812286),
                new Scale(41.1,37.346571381197386),
                new Scale(41.2,37.440869156824675),
                new Scale(41.3,37.535194499229405),
                new Scale(41.4,37.62954710834617),
                new Scale(41.5,37.72392728818978),
                new Scale(41.6,37.81833513751158),
                new Scale(41.7,37.91277075535389),
                new Scale(41.8,38.00723424105166),
                new Scale(41.9,38.101725694234034),
                new Scale(42,38.196245214825844),
                new Scale(42.1,38.29079290304928),
                new Scale(42.2,38.38536885942544),
                new Scale(42.3,38.47997318477597),
                new Scale(42.4,38.574605980224625),
                new Scale(42.5,38.66926734719898),
                new Scale(42.6,38.763957387431965),
                new Scale(42.7,38.85867620296358),
                new Scale(42.8,38.95342370848935),
                new Scale(42.9,39.0482003978771),
                new Scale(43,39.14300616968722),
                new Scale(43.1,39.237841127232855),
                new Scale(43.2,39.332705374142336),
                new Scale(43.3,39.42759901436077),
                new Scale(43.4,39.52252215215182),
                new Scale(43.5,39.61747489209931),
                new Scale(43.6,39.712457339108994),
                new Scale(43.7,39.80746959841019),
                new Scale(43.8,39.90251177555756),
                new Scale(43.9,39.99758414532758),
                new Scale(44,40.09268645208833),
                new Scale(44.1,40.187818996898045),
                new Scale(44.2,40.28298188656919),
                new Scale(44.3,40.378175228249184),
                new Scale(44.4,40.473399129422354),
                new Scale(44.5,40.56865355133576),
                new Scale(44.6,40.6639389435094),
                new Scale(44.7,40.75925538503424),
                new Scale(44.8,40.85460239453565),
                new Scale(44.9,40.94998075735463),
                new Scale(45,41.045390408782076),
                new Scale(45.1,41.140831296786985),
                new Scale(45.2,41.23630361369969),
                new Scale(45.3,41.33180747024996),
                new Scale(45.4,41.4273429775209),
                new Scale(45.5,41.52291005219012),
                new Scale(45.6,41.618509176229736),
                new Scale(45.7,41.714140288568345),
                new Scale(45.8,41.809803501605145),
                new Scale(45.9,41.905498928105054),
                new Scale(46,42.00122668120064),
                new Scale(46.1,42.09698687439409),
                new Scale(46.2,42.19277962155946),
                new Scale(46.3,42.28860503694436),
                new Scale(46.4,42.38446323517234),
                new Scale(46.5,42.4803543312448),
                new Scale(46.6,42.57627844054296),
                new Scale(46.7,42.672235678830134),
                new Scale(46.8,42.768226162253626),
                new Scale(46.9,42.86425000734708),
                new Scale(47,42.960307331032354),
                new Scale(47.1,43.056398250621754),
                new Scale(47.2,43.1525228838202),
                new Scale(47.3,43.24868134872733),
                new Scale(47.4,43.34487376383968),
                new Scale(47.5,43.44110024805286),
                new Scale(47.6,43.53736092066375),
                new Scale(47.7,43.63365590137271),
                new Scale(47.8,43.72998531028581),
                new Scale(47.9,43.82634926791702),
                new Scale(48,43.92274789519047),
                new Scale(48.1,44.019181313442736),
                new Scale(48.2,44.115649644425076),
                new Scale(48.3,44.212153010305784),
                new Scale(48.4,44.30869153367235),
                new Scale(48.5,44.405265337533976),
                new Scale(48.6,44.50187454532376),
                new Scale(48.7,44.59851928090103),
                new Scale(48.8,44.695199668553805),
                new Scale(48.9,44.7919158330012),
                new Scale(49,44.8886678993956),
                new Scale(49.1,44.9854559933253),
                new Scale(49.2,45.082280240816836),
                new Scale(49.3,45.1791407683374),
                new Scale(49.4,45.27603784391745),
                new Scale(49.5,45.37297130540214),
                new Scale(49.6,45.46994142916271),
                new Scale(49.7,45.56694834346518),
                new Scale(49.8,45.663992177027126),
                new Scale(49.9,45.76107305902025),
                new Scale(50,45.85819111907313),
                new Scale(50.1,45.95534648727379),
                new Scale(50.2,46.0525392941724),
                new Scale(50.3,46.14976967078397),
                new Scale(50.4,46.24703774859103),
                new Scale(50.5,46.34434365954641),
                new Scale(50.6,46.441687536075925),
                new Scale(50.7,46.539069511081166),
                new Scale(50.8,46.63648971794224),
                new Scale(50.9,46.73394829052065),
                new Scale(51,46.83144536316199),
                new Scale(51.1,46.92898107069889),
                new Scale(51.2,47.026555548453715),
                new Scale(51.3,47.12416893224157),
                new Scale(51.4,47.221821358373155),
                new Scale(51.5,47.31951296365762),
                new Scale(51.6,47.41724388540548),
                new Scale(51.7,47.515014138808205),
                new Scale(51.8,47.61282411777857),
                new Scale(51.9,47.710673827558516),
                new Scale(52,47.80856340751233),
                new Scale(52.1,47.90649299752134),
                new Scale(52.2,48.00446273798691),
                new Scale(52.3,48.102472769833405),
                new Scale(52.4,48.200523234511),
                new Scale(52.5,48.29861427399872),
                new Scale(52.6,48.39674603080743),
                new Scale(52.7,48.494918647982786),
                new Scale(52.8,48.59313226910837),
                new Scale(52.9,48.691387038308655),
                new Scale(53,48.78968310025223),
                new Scale(53.1,48.88802060015477),
                new Scale(53.2,48.9863996837823),
                new Scale(53.3,49.08482060249574),
                new Scale(53.4,49.183283279119905),
                new Scale(53.5,49.28178798134636),
                new Scale(53.6,49.38033485710504),
                new Scale(53.7,49.47892405489317),
                new Scale(53.8,49.57755572377897),
                new Scale(53.9,49.67623001340509),
                new Scale(54,49.774947073992195),
                new Scale(54.1,49.873707056342525),
                new Scale(54.2,49.97251011184355),
                new Scale(54.3,50.071356317033015),
                new Scale(54.4,50.17024600026933),
                new Scale(54.5,50.269179211338),
                new Scale(54.6,50.368156160220536),
                new Scale(54.7,50.467176792715435),
                new Scale(54.8,50.56624155429735),
                new Scale(54.9,50.66535042245676),
                new Scale(55,50.76450359434261),
                new Scale(55.1,50.86370122695304),
                new Scale(55.2,50.96294347790058),
                new Scale(55.3,51.062230505415414),
                new Scale(55.4,51.161562468348976),
                new Scale(55.5,51.26093952617757),
                new Scale(55.6,51.360361839005925),
                new Scale(55.7,51.45982956757118),
                new Scale(55.8,51.559342873246344),
                new Scale(55.9,51.65890191804445),
                new Scale(56,51.75850686462231),
                new Scale(56.1,51.85815787628459),
                new Scale(56.2,51.95785511698781),
                new Scale(56.3,52.05759875134445),
                new Scale(56.4,52.1573889446273),
                new Scale(56.5,52.25722586277333),
                new Scale(56.6,52.357109672388376),
                new Scale(56.7,52.45704054075116),
                new Scale(56.8,52.55701863581792),
                new Scale(56.9,52.657044126226694),
                new Scale(57,52.75711718130186),
                new Scale(57.1,52.85723797105872),
                new Scale(57.2,52.95740666620804),
                new Scale(57.3,53.05762343816069),
                new Scale(57.4,53.157888459032286),
                new Scale(57.5,53.25820190164793),
                new Scale(57.6,53.35856393954693),
                new Scale(57.7,53.45897474698761),
                new Scale(57.8,53.55943449895204),
                new Scale(57.9,53.65994337115101),
                new Scale(58,53.76050154002871),
                new Scale(58.1,53.861109182767805),
                new Scale(58.2,53.96176647729427),
                new Scale(58.3,54.06247354948585),
                new Scale(58.4,54.16323069369239),
                new Scale(58.5,54.26403802689887),
                new Scale(58.6,54.364895730105246),
                new Scale(58.7,54.46580398508696),
                new Scale(58.8,54.56676297439827),
                new Scale(58.9,54.66777288137617),
                new Scale(59,54.76883389014373),
                new Scale(59.1,54.869946185614246),
                new Scale(59.2,54.97110998623515),
                new Scale(59.3,55.07232538834865),
                new Scale(59.4,55.17359264172372),
                new Scale(59.5,55.27491193398819),
                new Scale(59.6,55.37628345357079),
                new Scale(59.7,55.477707434903884),
                new Scale(59.8,55.5791839820861),
                new Scale(59.9,55.68071332421624),
                new Scale(60,55.782295653509834),
                new Scale(60.1,55.88393116301766),
                new Scale(60.2,55.98562004663097),
                new Scale(60.3,56.08736249908715),
                new Scale(60.4,56.18915871597521),
                new Scale(60.5,56.291008893741555),
                new Scale(60.6,56.392913229695935),
                new Scale(60.7,56.494871899815436),
                new Scale(60.8,56.59688515205384),
                new Scale(60.9,56.698953159192136),
                new Scale(61,56.80107612197924),
                new Scale(61.1,56.903254242097056),
                new Scale(61.2,57.00548772216267),
                new Scale(61.3,57.10777676573007),
                new Scale(61.4,57.210121577290906),
                new Scale(61.5,57.31252236227449),
                new Scale(61.6,57.414979327047575),
                new Scale(61.7,57.51749267821285),
                new Scale(61.8,57.62006261813725),
                new Scale(61.9,57.722689377824146),
                new Scale(62,57.82537314415946),
                new Scale(62.1,57.92811413617461),
                new Scale(62.2,58.0309125632826),
                new Scale(62.3,58.13376864558457),
                new Scale(62.4,58.23668259106711),
                new Scale(62.5,58.339654615513005),
                new Scale(62.6,58.44268493507765),
                new Scale(62.7,58.54577376704767),
                new Scale(62.8,58.64892132932632),
                new Scale(62.9,58.75212784105997),
                new Scale(63,58.85539352259153),
                new Scale(63.1,58.9587185955441),
                new Scale(63.2,59.06210327213969),
                new Scale(63.3,59.1655477891124),
                new Scale(63.4,59.26905236524145),
                new Scale(63.5,59.37261722576298),
                new Scale(63.6,59.47624259703248),
                new Scale(63.7,59.57992870655397),
                new Scale(63.8,59.683675783014934),
                new Scale(63.9,59.787484056328985),
                new Scale(64,59.8913537576869),
                new Scale(64.1,59.99528508978247),
                new Scale(64.2,60.09927833167096),
                new Scale(64.3,60.203333697604336),
                new Scale(64.4,60.307451422643425),
                new Scale(64.5,60.41163174303078),
                new Scale(64.6,60.51587489621474),
                new Scale(64.7,60.62018112087785),
                new Scale(64.8,60.72455065697031),
                new Scale(64.9,60.82898374574919),
                new Scale(65,60.93348058779547),
                new Scale(65.1,61.03804149518087),
                new Scale(65.2,61.14266668204629),
                new Scale(65.3,61.2473563938892),
                new Scale(65.4,61.35211087745966),
                new Scale(65.5,61.45693038078301),
                new Scale(65.6,61.561815153186494),
                new Scale(65.7,61.66676544533009),
                new Scale(65.8,61.77178150924232),
                new Scale(65.9,61.876863546110684),
                new Scale(66,61.98201189804331),
                new Scale(66.1,62.087226781347695),
                new Scale(66.2,62.1925084526476),
                new Scale(66.3,62.297857169902606),
                new Scale(66.4,62.40327319243237),
                new Scale(66.5,62.508756780944545),
                new Scale(66.6,62.61430819756713),
                new Scale(66.7,62.71992770588609),
                new Scale(66.8,62.82561550508198),
                new Scale(66.9,62.931371973618695),
                new Scale(67,63.0371973282639),
                new Scale(67.1,63.143091837532026),
                new Scale(67.2,63.249055771373335),
                new Scale(67.3,63.3550894012021),
                new Scale(67.4,63.461192999929885),
                new Scale(67.5,63.567366842004084),
                new Scale(67.6,63.6736112034534),
                new Scale(67.7,63.77992627288181),
                new Scale(67.8,63.8863124821765),
                new Scale(67.9,63.9927700421278),
                new Scale(68,64.09929923400159),
                new Scale(68.1,64.20590034062519),
                new Scale(68.2,64.31257364642559),
                new Scale(68.3,64.41931943747431),
                new Scale(68.4,64.52613792101155),
                new Scale(68.5,64.63302952463326),
                new Scale(68.6,64.73999447595196),
                new Scale(68.7,64.8470330666651),
                new Scale(68.8,64.95414559011735),
                new Scale(68.9,65.06133234134303),
                new Scale(69,65.1685936171162),
                new Scale(69.1,65.27592971601153),
                new Scale(69.2,65.38334083239013),
                new Scale(69.3,65.49082745070429),
                new Scale(69.4,65.59838979125625),
                new Scale(69.5,65.70602815856293),
                new Scale(69.6,65.813742858955),
                new Scale(69.7,65.92153420064173),
                new Scale(69.8,66.02940239777092),
                new Scale(69.9,66.13734792665652),
                new Scale(70,66.24537102571807),
                new Scale(70.1,66.35347200949454),
                new Scale(70.2,66.46165119444811),
                new Scale(70.3,66.56990889904417),
                new Scale(70.4,66.67824544385151),
                new Scale(70.5,66.78666102311101),
                new Scale(70.6,66.89515618053521),
                new Scale(70.7,67.0037311424998),
                new Scale(70.8,67.11238623627574),
                new Scale(70.9,67.22112179134454),
                new Scale(71,67.32993802272948),
                new Scale(71.1,67.43883546154582),
                new Scale(71.2,67.54781435342444),
                new Scale(71.3,67.65687503500762),
                new Scale(71.4,67.76601784534998),
                new Scale(71.5,67.87524300476669),
                new Scale(71.6,67.98455105960154),
                new Scale(71.7,68.09394226328536),
                new Scale(71.8,68.20341696262496),
                new Scale(71.9,68.31297550726445),
                new Scale(72,68.42261810242128),
                new Scale(72.1,68.53234534543515),
                new Scale(72.2,68.64215748348539),
                new Scale(72.3,68.75205487516494),
                new Scale(72.4,68.86203772695991),
                new Scale(72.5,68.97210665397445),
                new Scale(72.6,69.08226191034909),
                new Scale(72.7,69.19250372882297),
                new Scale(72.8,69.30283269495393),
                new Scale(72.9,69.4132490877319),
                new Scale(73,69.52375314413113),
                new Scale(73.1,69.63434545887641),
                new Scale(73.2,69.74502632409407),
                new Scale(73.3,69.85579594668087),
                new Scale(73.4,69.96665499388877),
                new Scale(73.5,70.07760356505128),
                new Scale(73.6,70.1886422052313),
                new Scale(73.7,70.29977139706256),
                new Scale(73.8,70.4109913049076),
                new Scale(73.9,70.522302336506),
                new Scale(74,70.63370506935775),
                new Scale(74.1,70.74519960439594),
                new Scale(74.2,70.85678665902645),
                new Scale(74.3,70.9684664909676),
                new Scale(74.4,71.08023958753758),
                new Scale(74.5,71.19210609157356),
                new Scale(74.6,71.30406675901004),
                new Scale(74.7,71.41612163993027),
                new Scale(74.8,71.5282714157162),
                new Scale(74.9,71.6405164088223),
                new Scale(75,71.75285703455971),
                new Scale(75.1,71.86529371076591),
                new Scale(75.2,71.97782685782448),
                new Scale(75.3,72.09045689868934),
                new Scale(75.4,72.2031842589029),
                new Scale(75.5,72.31600955448457),
                new Scale(75.6,72.42893265264105),
                new Scale(75.7,72.54195455040737),
                new Scale(75.8,72.65507549605461),
                new Scale(75.9,72.76829592841838),
                new Scale(76,72.88161628906279),
                new Scale(76.1,72.99503702230324),
                new Scale(76.2,73.10855870301903),
                new Scale(76.3,73.22218156418882),
                new Scale(76.4,73.33590607178803),
                new Scale(76.5,73.44973254565681),
                new Scale(76.6,73.5636620241573),
                new Scale(76.7,73.67769448075197),
                new Scale(76.8,73.79183049924741),
                new Scale(76.9,73.90607054685842),
                new Scale(77,74.0204149518906),
                new Scale(77.1,74.13486474571991),
                new Scale(77.2,74.24941958136044),
                new Scale(77.3,74.36408047753446),
                new Scale(77.4,74.47884799684203),
                new Scale(77.5,74.59372198652997),
                new Scale(77.6,74.7087035734586),
                new Scale(77.7,74.82379303667689),
                new Scale(77.8,74.93899087117707),
                new Scale(77.9,75.05429757517756),
                new Scale(78,75.16971365015426),
                new Scale(78.1,75.28523960086956),
                new Scale(78.2,75.40087567302587),
                new Scale(78.3,75.51662332651291),
                new Scale(78.4,75.63248196851657),
                new Scale(78.5,75.74845218312625),
                new Scale(78.6,75.86453539103555),
                new Scale(78.7,75.9807313840381),
                new Scale(78.8,76.09704088069454),
                new Scale(78.9,76.2134646913669),
                new Scale(79,76.33000268174182),
                new Scale(79.1,76.44665573209676),
                new Scale(79.2,76.56342460086088),
                new Scale(79.3,76.68030967012577),
                new Scale(79.4,76.797311490239),
                new Scale(79.5,76.9144306152898),
                new Scale(79.6,77.03166760314305),
                new Scale(79.7,77.1490230154748),
                new Scale(79.8,77.26649741780905),
                new Scale(79.9,77.38409137955462),
                new Scale(80,77.50180515118542),
                new Scale(80.1,77.61963999681457),
                new Scale(80.2,77.73759660782959),
                new Scale(80.3,77.8556745605099),
                new Scale(80.4,77.97387508006804),
                new Scale(80.5,78.09219850479803),
                new Scale(80.6,78.21064543876615),
                new Scale(80.7,78.32921719230691),
                new Scale(80.8,78.44791313268556),
                new Scale(80.9,78.56673510717722),
                new Scale(81,78.68568240344855),
                new Scale(81.1,78.80475728776634),
                new Scale(81.2,78.92395917516407),
                new Scale(81.3,79.04328929770303),
                new Scale(81.4,79.16274773416085),
                new Scale(81.5,79.28233544804907),
                new Scale(81.6,79.40205295160372),
                new Scale(81.7,79.52190073844402),
                new Scale(81.8,79.64188030960905),
                new Scale(81.9,79.76199102007637),
                new Scale(82,79.88223485248407),
                new Scale(82.1,80.00261153140342),
                new Scale(82.2,80.12312142149877),
                new Scale(82.3,80.24376675046655),
                new Scale(82.4,80.36454719584056),
                new Scale(82.5,80.48546295904937),
                new Scale(82.6,80.60651585227787),
                new Scale(82.7,80.72770536913735),
                new Scale(82.8,80.84903285941846),
                new Scale(82.9,80.9704995621474),
                new Scale(83,81.09210505573056),
                new Scale(83.1,81.2138512031147),
                new Scale(83.2,81.33573814674739),
                new Scale(83.3,81.45776604243389),
                new Scale(83.4,99.34471981728312),
                new Scale(83.5,99.19400516380995),
                new Scale(83.6,99.04361702011425),
                new Scale(83.7,98.89355404785664),
                new Scale(83.8,98.74381246878035),
                new Scale(83.9,98.59439012380237),
                new Scale(84,98.44528456356824),
                new Scale(84.1,98.29649360854866),
                new Scale(84.2,98.14801501394757),
                new Scale(84.3,97.9998452492036),
                new Scale(84.4,97.85198327721443),
                new Scale(84.5,97.70442631152487),
                new Scale(84.6,97.55717184472314),
                new Scale(84.7,97.41021754387113),
                new Scale(84.8,97.26356153710037),
                new Scale(84.9,97.11720142202888),
                new Scale(85,96.97113534290418),
                new Scale(85.1,96.82536012735835),
                new Scale(85.2,96.67987440599487),
                new Scale(85.3,83.92922028904026),
                new Scale(85.4,84.05439822220768),
                new Scale(85.5,84.179736309197),
                new Scale(85.6,84.30523299030666),
                new Scale(85.7,84.43089154586865),
                new Scale(85.8,84.55671159224056),
                new Scale(85.9,84.68269382476167),
                new Scale(86,84.80883905616687),
                new Scale(86.1,84.93514887404675),
                new Scale(86.2,85.06162431869383),
                new Scale(86.3,85.1882660359938),
                new Scale(86.4,85.31507452447352),
                new Scale(86.5,85.44205143058878),
                new Scale(86.6,85.5691969716523),
                new Scale(86.7,85.69651227110286),
                new Scale(86.8,85.82399906010303),
                new Scale(86.9,85.95165723137703),
                new Scale(87,86.07948832886065),
                new Scale(87.1,86.20749330127882),
                new Scale(87.2,86.3356732955735),
                new Scale(87.3,86.46402938099925),
                new Scale(87.4,86.59256141189826),
                new Scale(87.5,86.72127226434644),
                new Scale(87.6,86.85016091719926),
                new Scale(87.7,86.97923058917773),
                new Scale(87.8,87.10847999701272),
                new Scale(87.9,87.2379128471261),
                new Scale(88,87.36752800476349),
                new Scale(88.1,87.49732723506493),
                new Scale(88.2,87.62731123267811),
                new Scale(88.3,87.75748216717722),
                new Scale(88.4,87.88784008415288),
                new Scale(88.5,88.01838748184547),
                new Scale(88.6,88.14912372611828),
                new Scale(88.7,88.28005119631625),
                new Scale(88.8,88.41116980156693),
                new Scale(88.9,88.54248285257695),
                new Scale(89,88.67398916986309),
                new Scale(89.1,88.8056902427156),
#endregion
                new Scale(89.2,88.93758951725374),
                new Scale(89.3,89.06968556265399),
                new Scale(89.4,89.20198021348405),
                new Scale(89.5,89.3344767572162),
            };

        private static readonly ImmutableSortedSet<Scale> ScalesLookup = 
            Scales.ToImmutableSortedSet(new LatitudeCompareScale());

        public EckertIVProjection() { }

        public override bool IsNormalCylindrical
        {
            get { return true; }
        }

        public override Vector GetRelativeScale(Location location)
        {
            var scale = getScale(location);
            location = new Location(1.0, 1.0);
            var (x, y) = LocationToMap(scale, LongitudeOffset(location), location.Latitude);
            return new Vector(x, y);
        }

        /// <summary>
        /// Given a sphere of radius R, central meridian λ0 and a point with 
        /// geographical latitude φ and longitude λ, plane. 
        /// </summary>
        /// <param name="location"></param>
        /// <returns></returns>
        public override Point LocationToMap(Location location)
        {
            var scale = getScale(location);
            var (x, y) = LocationToMap(scale, LongitudeOffset(location), location.Latitude);

            return new Point(x, y);
        }

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        private (double, double) LocationToMap(Scale scale, double longitude, double latitude)
        {
            var x = xConst * longitude * (1.0 + scale.thetaCos);
            var y = yConst * scale.thetaSin;

            return (x, y);
        }

        /// <summary>
        /// Inverse formulae
        /// </summary>
        /// <param name="point"></param>
        /// <returns></returns>
        public override Location MapToLocation(Point point)
        {
            var θ = Math.Asin(point.Y / yConst);
            var sinθ = Math.Sin(θ);
            var cosθ = Math.Cos(θ);
            var φ = RadiansToDegrees(
                Math.Asin((θ + sinθ * cosθ + 2.0 * sinθ)
                / TwoPiHalf));
            var λ = Center.Longitude + point.X / (xConst * (1.0 + cosθ));

            return new Location(φ, λ);
        }


        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        private double LongitudeOffset(Location loc)
        {
            return loc.Longitude - Center.Longitude;
        }

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        private Scale getScale(Location loc)
        {
            return Scale.FindScale(ScalesLookup, s => s.latitude, loc.Latitude);
        }


    }
}
